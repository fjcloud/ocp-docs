

<!DOCTYPE html>
<!--[if IE 8]> <html class="ie8"> <![endif]-->
<!--[if IE 9]> <html class="ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html>
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  
  
  
  <title>Compliance Operator scans - Compliance Operator | Security and compliance | Azure Red Hat OpenShift Branch Build</title>
  <link href="https://assets.openshift.net/content/subdomain.css" rel="stylesheet" type="text/css"/>
  <link href="https://docs.okd.io/latest/_stylesheets/search.css" rel="stylesheet" media="screen"/>
  <link href="https://docs.okd.io/latest/_stylesheets/autumn.css" rel="stylesheet"  media="screen"/>
  <link href="https://assets.openshift.net/content/subdomain/touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" type="image/png"/>
  <link href="https://assets.openshift.net/content/subdomain/favicon32x32.png" rel="shortcut icon" type="text/css"/>
  <link href="https://assets.openshift.net/content/osh-nav-footer.css" rel="stylesheet" type="text/css" media="screen"/>
  <link href="https://docs.okd.io/latest/_stylesheets/docs.css" rel="stylesheet"  media="screen"/>
  <link href="https://docs.okd.io/latest/_stylesheets/print.css" rel="stylesheet" type="text/css" media="print"/>
  <!--[if IE]><link rel="shortcut icon" href="https://assets.openshift.net/content/subdomain/favicon.ico"><![endif]-->
  <!-- or, set /favicon.ico for IE10 win -->
  <meta content="OpenShift" name="application-name">
  <meta content="#000000" name="msapplication-TileColor">
  <meta content="https://assets.openshift.net/content/subdomain/touch-icon-precomposed.png" name="msapplication-TileImage">

  <!-- Adobe DTM -->
  <script src="//www.redhat.com/dtm.js" type="text/javascript"></script>
  <!-- End Adobe DTM -->

  <script id="trustarc" src="https://static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"
        rel="stylesheet">

</head>

<body onload="selectVersion('Branch Build');">
  
<nav id="main">
  <div class="container">
    <div class="row">
      <div class="navbar navbar-default navbar-openshift" role="navigation">
        <div class="navbar-header">
            <a href="#nav-main" class="dropdown-toggle navbar-menu-toggle hidden visible-xs" data-toggle="collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </a>
          <a class="navbar-brand" href="/"></a>
        </div>
        <div id="nav-main" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li id="products" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="true">
                Products <span class="fa fa-angle-down"></span>
              </a>
              <div class="dropdown-menu">
                <div class="row flex-column flex-md-row">
                  <div class="col-xs-12 col-sm-3">
                    <h3>Overview</h3>
                    <ul class="nav flex-column">
                      <li><a target="_blank" href="https://www.openshift.com/products/features/">Features</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/products/pricing/">Pricing</a></li>
                    </ul>
                  </div>
                  <div class="col-xs-12 col-sm-9">
                    <h3>Featured Products</h3>
                    <ul class="nav">
                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/container-platform/">Red Hat OpenShift Container&nbsp;Platform</a>
                        <p class="d-none d-md-block">Build, deploy and manage your applications across cloud- and on-premise infrastructure</p>
                      </li>
                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/dedicated/">Red Hat OpenShift Dedicated</a>
                        <p class="d-none d-md-block">Single-tenant, high-availability Kubernetes clusters in the public cloud</p>
                      </li>

                      <li>
                        <a target="_blank" href="https://www.openshift.com/products/online/">Red Hat OpenShift Online</a>
                        <p class="d-none d-md-block">The fastest way for developers to build, host and scale applications in the public cloud</p>
                      </li>

                      <li class="nav-item">
                        <a target="_blank" href="https://www.openshift.com/products/">All products <span class="fa fa-angle-right"></span></a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </li>

            <li id="learn" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Learn <span class="fa fa-angle-down"></span>
              </a>
              <div class="dropdown-menu">
                <div class="row flex-md-nowrap">
                  <div class="col-xs-12 col-sm-6">
                    <h3>Learn</h3>
                    <ul class="nav">
                      <li><a target="_blank" href="https://www.openshift.com/learn/what-is-openshift/">What is OpenShift</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/get-started/">Get started</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/partners/">Partners</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/success-stories/">Customer success stories</a></li>
                      <li><a target="_blank" href="https://blog.openshift.com">Blog</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/resources/">Resources</a></li>
                    </ul>
                  </div>
                  <div class="col-xs-12 col-sm-6">
                    <h3>Technology Topics</h3>
                    <ul class="nav">
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/knative/">Knative</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/security/">Security</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/kubernetes/">Kubernetes</a></li>
                      <li><a target="_blank" href="https://www.openshift.com/learn/topics/service-brokers/">Service Brokers</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Community <span class="fa fa-angle-down"></span>
              </a>
              <ul class="dropdown-menu">
                <li><a target="_blank" href="https://commons.openshift.org">OpenShift Commons</a></li>
                <li><a target="_blank" href="https://www.okd.io">Open Source (OKD)</a></li>
                <li><a target="_blank" href="https://www.openshift.com/community/programs/startups/">Startups</a></li>
                <li><a target="_blank" href="https://www.openshift.com/community/programs/grants/">Grants</a></li>
              </ul>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Support <span class="fa fa-angle-down"></span>
              </a>
              <ul class="dropdown-menu">
                <li><a target="_blank" href="https://help.openshift.com">Help Center</a></li>
                <li><a href="https://docs.openshift.com">OpenShift Docs</a></li>
              </ul>
            </li>

            <li><a target="_blank" class="nav-sign-up" href="https://www.openshift.com/trial/">Free Trial</a></li>

            <li><a target="_blank" href="https://console.redhat.com/openshift" class="nav-sign-in">Log In <span class="fa fa-angle-right"></span></a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</nav>

  
  <div class="container">
    <button id="hc-open-btn" class="open-btn-sm" onclick="openNav()" aria-label="Open"><span class="fa fa-bars" /></button>
    <ol class="breadcrumb hide-for-print">
      
      <span>
        <div class="alert alert-info" role="primary" id="support-info">
          <strong>Starting on March 12, 2025, OpenShift docs will only be available at <a href="https://docs.redhat.com/en/" style="color: #0C5460 !important" class="link-primary">docs.redhat.com</a>. From that time on, docs.openshift.com links will automatically redirect to their locations on docs.redhat.com.
          </strong>
        </div>
      </span>
      

      

      

      

      

      

      

      
      

      

      


      

      


      

      

      <li class="sitename">
        <a href="/">
          Documentation</a>
      </li>
      <li class="hidden-xs active">
        
          <a href="../../../security/index.html">Azure Red Hat OpenShift Branch Build</a>
        
      </li>
      <li class="hidden-xs active">
        <a href="../../../security/index.html">Security and compliance</a>
      </li>
      <li class="hidden-xs active"><a href="../../../security/compliance_operator/co-overview.html">Compliance Operator</a></li>
      <li class="hidden-xs active"><a href="../../../security/compliance_operator/co-scans/compliance-operator-supported-profiles.html">Compliance Operator scan management</a></li>
      <li class="hidden-xs active">
        Compliance Operator scans
      </li>
      
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas hide-for-print">
        <div class="row-fluid">
          <div id="btn-close">
            <button id="hc-close-btn" onclick="closeNav()" class="close-btn-sm" aria-label="close"><span class="fa fa-times" /></button>
          </div>
          <div id="hc-search">
            <input id="hc-search-input" type="text" aria-label="search">
            <button id="hc-search-btn" aria-label="search"><span class="fa fa-search" /></button>
          </div>
        </div>
        <ul class="nav nav-sidebar">
    <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup0"><span id="tgSpan0" class="fa fa-angle-down"></span>Security and compliance</a>
      <ul id="topicGroup0" class="collapse in list-unstyled">
            <li><a class="" href="../../../security/index.html">Security and compliance overview</a></li>
            <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-0-1"><span id="sgSpan-0-1" class="fa fa-caret-right"></span>&nbsp;Container security</a>
              <ul id="topicSubGroup-0-1" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../../../security/container_security/security-understanding.html">Understanding container security</a></li>
                  <li><a class="" href="../../../security/container_security/security-hosts-vms.html">Understanding host and VM security</a></li>
                  <li><a class="" href="../../../security/container_security/security-hardening.html">Hardening Red Hat Enterprise Linux CoreOS</a></li>
                  <li><a class="" href="../../../security/container_security/security-container-signature.html">Container image signatures</a></li>
                  <li><a class="" href="../../../security/container_security/security-compliance.html">Understanding compliance</a></li>
                  <li><a class="" href="../../../security/container_security/security-container-content.html">Securing container content</a></li>
                  <li><a class="" href="../../../security/container_security/security-registries.html">Using container registries securely</a></li>
                  <li><a class="" href="../../../security/container_security/security-build.html">Securing the build process</a></li>
                  <li><a class="" href="../../../security/container_security/security-deploy.html">Deploying containers</a></li>
                  <li><a class="" href="../../../security/container_security/security-platform.html">Securing the container platform</a></li>
                  <li><a class="" href="../../../security/container_security/security-network.html">Securing networks</a></li>
                  <li><a class="" href="../../../security/container_security/security-storage.html">Securing attached storage</a></li>
                  <li><a class="" href="../../../security/container_security/security-monitoring.html">Monitoring cluster events and logs</a></li>              </ul>
            </li>
            <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-0-2"><span id="sgSpan-0-2" class="fa fa-caret-down"></span>&nbsp;Compliance Operator</a>
              <ul id="topicSubGroup-0-2" class="nav-tertiary list-unstyled collapse in">

                  <li><a class="" href="../../../security/compliance_operator/co-overview.html">Compliance Operator overview</a></li>
                  <li><a class="" href="../../../security/compliance_operator/compliance-operator-release-notes.html">Compliance Operator release notes</a></li>
                  <li><a class="" href="../../../security/compliance_operator/co-support.html">Compliance Operator support</a></li>
                <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubSubGroup-0-2-3"><span id="ssgSpan-0-2-3" class="fa fa-caret-right"></span>&nbsp;Compliance Operator concepts</a>
                  <ul id="topicSubSubGroup-0-2-3" class="nav-tertiary list-unstyled collapse">

                    <li><a class="" href="../../../security/compliance_operator/co-concepts/compliance-operator-understanding.html" style="padding-left: 70px;">Understanding the Compliance Operator</a></li>
                    <li><a class="" href="../../../security/compliance_operator/co-concepts/compliance-operator-crd.html" style="padding-left: 70px;">Understanding the Custom Resource Definitions</a></li>                  </ul>
                  </li>

                <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubSubGroup-0-2-4"><span id="ssgSpan-0-2-4" class="fa fa-caret-right"></span>&nbsp;Compliance Operator management</a>
                  <ul id="topicSubSubGroup-0-2-4" class="nav-tertiary list-unstyled collapse">

                    <li><a class="" href="../../../security/compliance_operator/co-management/compliance-operator-installation.html" style="padding-left: 70px;">Installing the Compliance Operator</a></li>
                    <li><a class="" href="../../../security/compliance_operator/co-management/compliance-operator-updating.html" style="padding-left: 70px;">Updating the Compliance Operator</a></li>
                    <li><a class="" href="../../../security/compliance_operator/co-management/compliance-operator-manage.html" style="padding-left: 70px;">Managing the Compliance Operator</a></li>
                    <li><a class="" href="../../../security/compliance_operator/co-management/compliance-operator-uninstallation.html" style="padding-left: 70px;">Uninstalling the Compliance Operator</a></li>                  </ul>
                  </li>

                <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubSubGroup-0-2-5"><span id="ssgSpan-0-2-5" class="fa fa-caret-down"></span>&nbsp;Compliance Operator scan management</a>
                  <ul id="topicSubSubGroup-0-2-5" class="nav-tertiary list-unstyled collapse in">

                    <li><a class="" href="../../../security/compliance_operator/co-scans/compliance-operator-supported-profiles.html" style="padding-left: 70px;">Supported compliance profiles</a></li>
                    <li><a class=" active" href="../../../security/compliance_operator/co-scans/compliance-scans.html" style="padding-left: 70px;">Compliance Operator scans</a></li>
                    <li><a class="" href="../../../security/compliance_operator/co-scans/compliance-operator-tailor.html" style="padding-left: 70px;">Tailoring the Compliance Operator</a></li>
                    <li><a class="" href="../../../security/compliance_operator/co-scans/compliance-operator-raw-results.html" style="padding-left: 70px;">Retrieving Compliance Operator raw results</a></li>
                    <li><a class="" href="../../../security/compliance_operator/co-scans/compliance-operator-remediation.html" style="padding-left: 70px;">Managing Compliance Operator remediation</a></li>
                    <li><a class="" href="../../../security/compliance_operator/co-scans/compliance-operator-advanced.html" style="padding-left: 70px;">Performing advanced Compliance Operator tasks</a></li>
                    <li><a class="" href="../../../security/compliance_operator/co-scans/compliance-operator-troubleshooting.html" style="padding-left: 70px;">Troubleshooting Compliance Operator scans</a></li>
                    <li><a class="" href="../../../security/compliance_operator/co-scans/oc-compliance-plug-in-using.html" style="padding-left: 70px;">Using the oc-compliance plugin</a></li>                  </ul>
                  </li>
              </ul>
            </li>
            <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-0-3"><span id="sgSpan-0-3" class="fa fa-caret-right"></span>&nbsp;File Integrity Operator</a>
              <ul id="topicSubGroup-0-3" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../../../security/file_integrity_operator/fio-overview.html">File Integrity Operator Overview</a></li>
                  <li><a class="" href="../../../security/file_integrity_operator/file-integrity-operator-release-notes.html">File Integrity Operator release notes</a></li>
                  <li><a class="" href="../../../security/file_integrity_operator/fio-support.html">File Integrity Operator support</a></li>
                  <li><a class="" href="../../../security/file_integrity_operator/file-integrity-operator-installation.html">Installing the File Integrity Operator</a></li>
                  <li><a class="" href="../../../security/file_integrity_operator/file-integrity-operator-updating.html">Updating the File Integrity Operator</a></li>
                  <li><a class="" href="../../../security/file_integrity_operator/file-integrity-operator-understanding.html">Understanding the File Integrity Operator</a></li>
                  <li><a class="" href="../../../security/file_integrity_operator/file-integrity-operator-configuring.html">Configuring the File Integrity Operator</a></li>
                  <li><a class="" href="../../../security/file_integrity_operator/file-integrity-operator-advanced-usage.html">Performing advanced File Integrity Operator tasks</a></li>
                  <li><a class="" href="../../../security/file_integrity_operator/file-integrity-operator-troubleshooting.html">Troubleshooting the File Integrity Operator</a></li>              </ul>
            </li>
            <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-0-4"><span id="sgSpan-0-4" class="fa fa-caret-right"></span>&nbsp;Security Profiles Operator</a>
              <ul id="topicSubGroup-0-4" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../../../security/security_profiles_operator/spo-overview.html">Security Profiles Operator overview</a></li>
                  <li><a class="" href="../../../security/security_profiles_operator/spo-release-notes.html">Security Profiles Operator release notes</a></li>
                  <li><a class="" href="../../../security/security_profiles_operator/spo-support.html">Security Profiles Operator support</a></li>
                  <li><a class="" href="../../../security/security_profiles_operator/spo-understanding.html">Understanding the Security Profiles Operator</a></li>
                  <li><a class="" href="../../../security/security_profiles_operator/spo-enabling.html">Enabling the Security Profiles Operator</a></li>
                  <li><a class="" href="../../../security/security_profiles_operator/spo-seccomp.html">Managing seccomp profiles</a></li>
                  <li><a class="" href="../../../security/security_profiles_operator/spo-selinux.html">Managing SELinux profiles</a></li>
                  <li><a class="" href="../../../security/security_profiles_operator/spo-advanced.html">Advanced Security Profiles Operator tasks</a></li>
                  <li><a class="" href="../../../security/security_profiles_operator/spo-troubleshooting.html">Troubleshooting the Security Profiles Operator</a></li>
                  <li><a class="" href="../../../security/security_profiles_operator/spo-uninstalling.html">Uninstalling the Security Profiles Operator</a></li>              </ul>
            </li>
            <li><a class="" href="../../../security/audit-log-view.html">Viewing audit logs</a></li>
            <li><a class="" href="../../../security/audit-log-policy-config.html">Configuring the audit log policy</a></li>
            <li><a class="" href="../../../security/tls-security-profiles.html">Configuring TLS security profiles</a></li>
            <li><a class="" href="../../../security/seccomp-profiles.html">Configuring seccomp profiles</a></li>
            <li class="nav-header"><a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-0-9"><span id="sgSpan-0-9" class="fa fa-caret-right"></span>&nbsp;Network-Bound Disk Encryption (NBDE)</a>
              <ul id="topicSubGroup-0-9" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../../../security/network_bound_disk_encryption/nbde-about-disk-encryption-technology.html">About disk encryption technology</a></li>
                  <li><a class="" href="../../../security/network_bound_disk_encryption/nbde-tang-server-installation-considerations.html">Tang server installation considerations</a></li>
                  <li><a class="" href="../../../security/network_bound_disk_encryption/nbde-managing-encryption-keys.html">Tang server encryption key management</a></li>              </ul>
            </li>
      </ul>
    </li>
</ul>
      </div>
      <div id="hc-search-modal">
        <div id="hc-modal-content">
          <span id="hc-modal-close">&times;</span>
          <div id="hc-search-results-wrapper">
            <div id="hc-search-results"></div>
            <div id="hc-search-progress-indicator" class="text-center search-progress-indicator"><i class="fa fa-circle-o-notch fa-spin" style="font-size:42px"></i></div>
            <div class="text-center">
              <button id="hc-search-more-btn">Show more results</button>
            </div>
          </div>
        </div>
      </div>
      <div class="print-logo" style="display:none;">
        <img src="https://www.redhat.com/cms/managed-files/Logo-Red_Hat-OpenShift-A-Standard-RGB_0_0.svg" alt="print logo"/>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h1>
            Compliance Operator scans
          </h1>
        </div>
        
        
        <div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title"></div>
<ul class="sectlevel1">
<li><a href="#running-compliance-scans_compliance-operator-scans">Running compliance scans</a></li>
<li><a href="#compliance-custom-storage_compliance-operator-scans">Setting custom storage size for results</a>
<ul class="sectlevel2">
<li><a href="#using-custom-result-storage-values_compliance-operator-scans">Using custom result storage values</a></li>
</ul>
</li>
<li><a href="#running-compliance-scans-worker-node_compliance-operator-scans">Scheduling the result server pod on a worker node</a></li>
<li><a href="#compliance-scansetting-cr_compliance-operator-scans"><code>ScanSetting</code> Custom Resource</a></li>
<li><a href="#co-hcp-mgmt-config_compliance-operator-scans">Configuring the hosted control planes management cluster</a></li>
<li><a href="#compliance-applying-resource-requests-and-limits_compliance-operator-scans">Applying resource requests and limits</a></li>
<li><a href="#compliance-scheduling-pods-with-resource-requests_compliance-operator-scans">Scheduling Pods with container resource requests</a></li>
</ul>
</div>
<div class="paragraph">
<p>The <code>ScanSetting</code> and <code>ScanSettingBinding</code> APIs are recommended to run compliance scans with the Compliance Operator. For more information on these API objects, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc explain scansettings</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc explain scansettingbindings</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-compliance-scans_compliance-operator-scans"><a class="anchor" href="#running-compliance-scans_compliance-operator-scans"></a>Running compliance scans</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can run a scan using the Center for Internet Security (CIS) profiles. For convenience, the Compliance Operator creates a <code>ScanSetting</code> object with reasonable defaults on startup. This <code>ScanSetting</code> object is named <code>default</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For all-in-one control plane and worker nodes, the compliance scan runs twice on the worker and control plane nodes. The compliance scan might generate inconsistent scan results. You can avoid inconsistent results by defining only a single role in the <code>ScanSetting</code> object.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information about inconsistent scan results, see <a href="https://access.redhat.com/solutions/6970861">Compliance Operator shows INCONSISTENT scan result with worker node</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Inspect the <code>ScanSetting</code> object by running the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc describe scansettings default <span class="nt">-n</span> openshift-compliance</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example output</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">Name</span><span class="pi">:</span>                  <span class="s">default</span>
<span class="na">Namespace</span><span class="pi">:</span>             <span class="s">openshift-compliance</span>
<span class="na">Labels</span><span class="pi">:</span>                <span class="s">&lt;none&gt;</span>
<span class="na">Annotations</span><span class="pi">:</span>           <span class="s">&lt;none&gt;</span>
<span class="na">API Version</span><span class="pi">:</span>           <span class="s">compliance.openshift.io/v1alpha1</span>
<span class="na">Kind</span><span class="pi">:</span>                  <span class="s">ScanSetting</span>
<span class="na">Max Retry On Timeout</span><span class="pi">:</span>  <span class="m">3</span>
<span class="na">Metadata</span><span class="pi">:</span>
  <span class="na">Creation Timestamp</span><span class="pi">:</span>  <span class="s">2024-07-16T14:56:42Z</span>
  <span class="na">Generation</span><span class="pi">:</span>          <span class="m">2</span>
  <span class="na">Resource Version</span><span class="pi">:</span>    <span class="m">91655682</span>
  <span class="na">UID</span><span class="pi">:</span>                 <span class="s">50358cf1-57a8-4f69-ac50-5c7a5938e402</span>
<span class="na">Raw Result Storage</span><span class="pi">:</span>
  <span class="na">Node Selector</span><span class="pi">:</span>
    <span class="s">node-role.kubernetes.io/master</span><span class="pi">:</span>
  <span class="na">Pv Access Modes</span><span class="pi">:</span>
    <span class="s">ReadWriteOnce</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="na">Rotation</span><span class="pi">:</span>            <span class="s">3</span> <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="na">Size</span><span class="pi">:</span>                <span class="s">1Gi</span> <i class="conum" data-value="3"></i><b>(3)</b>
  <span class="na">Storage Class Name</span><span class="pi">:</span>  <span class="s">standard</span> <i class="conum" data-value="4"></i><b>(4)</b>
  <span class="na">Tolerations</span><span class="pi">:</span>
    <span class="na">Effect</span><span class="pi">:</span>              <span class="s">NoSchedule</span>
    <span class="na">Key</span><span class="pi">:</span>                 <span class="s">node-role.kubernetes.io/master</span>
    <span class="na">Operator</span><span class="pi">:</span>            <span class="s">Exists</span>
    <span class="na">Effect</span><span class="pi">:</span>              <span class="s">NoExecute</span>
    <span class="na">Key</span><span class="pi">:</span>                 <span class="s">node.kubernetes.io/not-ready</span>
    <span class="na">Operator</span><span class="pi">:</span>            <span class="s">Exists</span>
    <span class="na">Toleration Seconds</span><span class="pi">:</span>  <span class="m">300</span>
    <span class="na">Effect</span><span class="pi">:</span>              <span class="s">NoExecute</span>
    <span class="na">Key</span><span class="pi">:</span>                 <span class="s">node.kubernetes.io/unreachable</span>
    <span class="na">Operator</span><span class="pi">:</span>            <span class="s">Exists</span>
    <span class="na">Toleration Seconds</span><span class="pi">:</span>  <span class="m">300</span>
    <span class="na">Effect</span><span class="pi">:</span>              <span class="s">NoSchedule</span>
    <span class="na">Key</span><span class="pi">:</span>                 <span class="s">node.kubernetes.io/memory-pressure</span>
    <span class="na">Operator</span><span class="pi">:</span>            <span class="s">Exists</span>
<span class="na">Roles</span><span class="pi">:</span>
  <span class="s">master</span> <i class="conum" data-value="5"></i><b>(5)</b>
  <span class="s">worker</span> <i class="conum" data-value="5"></i><b>(5)</b>
<span class="na">Scan Tolerations</span><span class="pi">:</span> <i class="conum" data-value="6"></i><b>(6)</b>
  <span class="na">Operator</span><span class="pi">:</span>           <span class="s">Exists</span>
<span class="na">Schedule</span><span class="pi">:</span>             <span class="s">0 1 * * *</span> <i class="conum" data-value="7"></i><b>(7)</b>
<span class="na">Show Not Applicable</span><span class="pi">:</span>  <span class="no">false</span>
<span class="na">Strict Node Scan</span><span class="pi">:</span>     <span class="no">true</span>
<span class="na">Suspend</span><span class="pi">:</span>              <span class="no">false</span>
<span class="na">Timeout</span><span class="pi">:</span>              <span class="s">30m</span>
<span class="na">Events</span><span class="pi">:</span>               <span class="s">&lt;none&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The Compliance Operator creates a persistent volume (PV) that contains the results of the scans. By default, the PV will use access mode <code>ReadWriteOnce</code> because the Compliance Operator cannot make any assumptions about the storage classes configured on the cluster. Additionally, <code>ReadWriteOnce</code> access mode is available on most clusters. If you need to fetch the scan results, you can do so by using a helper pod, which also binds the volume. Volumes that use the <code>ReadWriteOnce</code> access mode can be mounted by only one pod at time, so it is important to remember to delete the helper pods. Otherwise, the Compliance Operator will not be able to reuse the volume for subsequent scans.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The Compliance Operator keeps results of three subsequent scans in the volume; older scans are rotated.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The Compliance Operator will allocate one GB of storage for the scan results.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>scansetting.rawResultStorage.storageClassName</code> field specifies the <code>storageClassName</code> value to use when creating the <code>PersistentVolumeClaim</code> object to store the raw results. The default value is null, which will attempt to use the default storage class configured in the cluster. If there is no default class specified, then you must set a default class.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>If the scan setting uses any profiles that scan cluster nodes, scan these node roles.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The default scan setting object scans all the nodes.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The default scan setting object runs scans at 01:00 each day.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As an alternative to the default scan setting, you can use <code>default-auto-apply</code>, which has the following settings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">Name</span><span class="pi">:</span>                      <span class="s">default-auto-apply</span>
<span class="na">Namespace</span><span class="pi">:</span>                 <span class="s">openshift-compliance</span>
<span class="na">Labels</span><span class="pi">:</span>                    <span class="s">&lt;none&gt;</span>
<span class="na">Annotations</span><span class="pi">:</span>               <span class="s">&lt;none&gt;</span>
<span class="na">API Version</span><span class="pi">:</span>               <span class="s">compliance.openshift.io/v1alpha1</span>
<span class="na">Auto Apply Remediations</span><span class="pi">:</span>   <span class="no">true</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="na">Auto Update Remediations</span><span class="pi">:</span>  <span class="no">true</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="na">Kind</span><span class="pi">:</span>                      <span class="s">ScanSetting</span>
<span class="na">Metadata</span><span class="pi">:</span>
  <span class="na">Creation Timestamp</span><span class="pi">:</span>  <span class="s">2022-10-18T20:21:00Z</span>
  <span class="na">Generation</span><span class="pi">:</span>          <span class="m">1</span>
  <span class="na">Managed Fields</span><span class="pi">:</span>
    <span class="na">API Version</span><span class="pi">:</span>  <span class="s">compliance.openshift.io/v1alpha1</span>
    <span class="na">Fields Type</span><span class="pi">:</span>  <span class="s">FieldsV1</span>
    <span class="na">fieldsV1</span><span class="pi">:</span>
      <span class="s">f:autoApplyRemediations:</span>
      <span class="s">f:autoUpdateRemediations:</span>
      <span class="s">f:rawResultStorage:</span>
        <span class="s">.</span><span class="pi">:</span>
        <span class="s">f:nodeSelector:</span>
          <span class="s">.</span><span class="pi">:</span>
          <span class="s">f:node-role.kubernetes.io/master:</span>
        <span class="s">f:pvAccessModes:</span>
        <span class="s">f:rotation:</span>
        <span class="s">f:size:</span>
        <span class="s">f:tolerations:</span>
      <span class="s">f:roles:</span>
      <span class="s">f:scanTolerations:</span>
      <span class="s">f:schedule:</span>
      <span class="s">f:showNotApplicable:</span>
      <span class="s">f:strictNodeScan:</span>
    <span class="na">Manager</span><span class="pi">:</span>         <span class="s">compliance-operator</span>
    <span class="na">Operation</span><span class="pi">:</span>       <span class="s">Update</span>
    <span class="na">Time</span><span class="pi">:</span>            <span class="s">2022-10-18T20:21:00Z</span>
  <span class="na">Resource Version</span><span class="pi">:</span>  <span class="m">38840</span>
  <span class="na">UID</span><span class="pi">:</span>               <span class="s">8cb0967d-05e0-4d7a-ac1c-08a7f7e89e84</span>
<span class="na">Raw Result Storage</span><span class="pi">:</span>
  <span class="na">Node Selector</span><span class="pi">:</span>
    <span class="s">node-role.kubernetes.io/master</span><span class="pi">:</span>
  <span class="na">Pv Access Modes</span><span class="pi">:</span>
    <span class="s">ReadWriteOnce</span>
  <span class="na">Rotation</span><span class="pi">:</span>  <span class="m">3</span>
  <span class="na">Size</span><span class="pi">:</span>      <span class="s">1Gi</span>
  <span class="na">Tolerations</span><span class="pi">:</span>
    <span class="na">Effect</span><span class="pi">:</span>              <span class="s">NoSchedule</span>
    <span class="na">Key</span><span class="pi">:</span>                 <span class="s">node-role.kubernetes.io/master</span>
    <span class="na">Operator</span><span class="pi">:</span>            <span class="s">Exists</span>
    <span class="na">Effect</span><span class="pi">:</span>              <span class="s">NoExecute</span>
    <span class="na">Key</span><span class="pi">:</span>                 <span class="s">node.kubernetes.io/not-ready</span>
    <span class="na">Operator</span><span class="pi">:</span>            <span class="s">Exists</span>
    <span class="na">Toleration Seconds</span><span class="pi">:</span>  <span class="m">300</span>
    <span class="na">Effect</span><span class="pi">:</span>              <span class="s">NoExecute</span>
    <span class="na">Key</span><span class="pi">:</span>                 <span class="s">node.kubernetes.io/unreachable</span>
    <span class="na">Operator</span><span class="pi">:</span>            <span class="s">Exists</span>
    <span class="na">Toleration Seconds</span><span class="pi">:</span>  <span class="m">300</span>
    <span class="na">Effect</span><span class="pi">:</span>              <span class="s">NoSchedule</span>
    <span class="na">Key</span><span class="pi">:</span>                 <span class="s">node.kubernetes.io/memory-pressure</span>
    <span class="na">Operator</span><span class="pi">:</span>            <span class="s">Exists</span>
<span class="na">Roles</span><span class="pi">:</span>
  <span class="s">master</span>
  <span class="s">worker</span>
<span class="na">Scan Tolerations</span><span class="pi">:</span>
  <span class="na">Operator</span><span class="pi">:</span>           <span class="s">Exists</span>
<span class="na">Schedule</span><span class="pi">:</span>             <span class="s">0 1 * * *</span>
<span class="na">Show Not Applicable</span><span class="pi">:</span>  <span class="no">false</span>
<span class="na">Strict Node Scan</span><span class="pi">:</span>     <span class="no">true</span>
<span class="na">Events</span><span class="pi">:</span>               <span class="s">&lt;none&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Setting <code>autoUpdateRemediations</code> and <code>autoApplyRemediations</code> flags to <code>true</code> allows you to easily create <code>ScanSetting</code> objects that auto-remediate without extra steps.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Create a <code>ScanSettingBinding</code> object that binds to the default <code>ScanSetting</code> object and scans the cluster using the <code>cis</code> and <code>cis-node</code> profiles. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">compliance.openshift.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ScanSettingBinding</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">cis-compliance</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">openshift-compliance</span>
<span class="na">profiles</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">ocp4-cis-node</span>
    <span class="na">kind</span><span class="pi">:</span> <span class="s">Profile</span>
    <span class="na">apiGroup</span><span class="pi">:</span> <span class="s">compliance.openshift.io/v1alpha1</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">ocp4-cis</span>
    <span class="na">kind</span><span class="pi">:</span> <span class="s">Profile</span>
    <span class="na">apiGroup</span><span class="pi">:</span> <span class="s">compliance.openshift.io/v1alpha1</span>
<span class="na">settingsRef</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">default</span>
  <span class="na">kind</span><span class="pi">:</span> <span class="s">ScanSetting</span>
  <span class="na">apiGroup</span><span class="pi">:</span> <span class="s">compliance.openshift.io/v1alpha1</span></code></pre>
</div>
</div>
</li>
<li>
<p>Create the <code>ScanSettingBinding</code> object by running:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc create <span class="nt">-f</span> &lt;file-name&gt;.yaml <span class="nt">-n</span> openshift-compliance</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point in the process, the <code>ScanSettingBinding</code> object is reconciled and based on the <code>Binding</code> and the <code>Bound</code> settings. The Compliance Operator creates a <code>ComplianceSuite</code> object and the associated <code>ComplianceScan</code> objects.</p>
</div>
</li>
<li>
<p>Follow the compliance scan progress by running:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get compliancescan <span class="nt">-w</span> <span class="nt">-n</span> openshift-compliance</code></pre>
</div>
</div>
<div class="paragraph">
<p>The scans progress through the scanning phases and eventually reach the <code>DONE</code> phase when complete. In most cases, the result of the scan is <code>NON-COMPLIANT</code>. You can review the scan results and start applying remediations to make the cluster compliant. See <em>Managing Compliance Operator remediation</em> for more information.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="compliance-custom-storage_compliance-operator-scans"><a class="anchor" href="#compliance-custom-storage_compliance-operator-scans"></a>Setting custom storage size for results</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While the custom resources such as <code>ComplianceCheckResult</code> represent an aggregated result of one check across all scanned nodes, it can be useful to review the raw results as produced by the scanner. The raw results are produced in the ARF format and can be large (tens of megabytes per node), it is impractical to store them in a Kubernetes resource backed by the <code>etcd</code> key-value store. Instead, every scan creates a persistent volume (PV) which defaults to 1GB size. Depending on your environment, you may want to increase the PV size accordingly. This is done using the <code>rawResultStorage.size</code> attribute that is exposed in both the <code>ScanSetting</code> and <code>ComplianceScan</code> resources.</p>
</div>
<div class="paragraph">
<p>A related parameter is <code>rawResultStorage.rotation</code> which controls how many scans are retained in the PV before the older scans are rotated. The default value is 3, setting the rotation policy to 0 disables the rotation. Given the default rotation policy and an estimate of 100MB per a raw ARF scan report, you can calculate the right PV size for your environment.</p>
</div>
<div class="sect2">
<h3 id="using-custom-result-storage-values_compliance-operator-scans"><a class="anchor" href="#using-custom-result-storage-values_compliance-operator-scans"></a>Using custom result storage values</h3>
<div class="paragraph">
<p>Because Azure Red Hat OpenShift can be deployed in a variety of public clouds or bare metal, the Compliance Operator cannot determine available storage configurations. By default, the Compliance Operator will try to create the PV for storing results using the default storage class of the cluster, but a custom storage class can be configured using the <code>rawResultStorage.StorageClassName</code> attribute.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If your cluster does not specify a default storage class, this attribute must be set.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Configure the <code>ScanSetting</code> custom resource to use a standard storage class and create persistent volumes that are 10GB in size and keep the last 10 results:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>ScanSetting</code> CR</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">compliance.openshift.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ScanSetting</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">default</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">openshift-compliance</span>
<span class="na">rawResultStorage</span><span class="pi">:</span>
  <span class="na">storageClassName</span><span class="pi">:</span> <span class="s">standard</span>
  <span class="na">rotation</span><span class="pi">:</span> <span class="m">10</span>
  <span class="na">size</span><span class="pi">:</span> <span class="s">10Gi</span>
<span class="na">roles</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">worker</span>
<span class="pi">-</span> <span class="s">master</span>
<span class="na">scanTolerations</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">effect</span><span class="pi">:</span> <span class="s">NoSchedule</span>
  <span class="na">key</span><span class="pi">:</span> <span class="s">node-role.kubernetes.io/master</span>
  <span class="na">operator</span><span class="pi">:</span> <span class="s">Exists</span>
<span class="na">schedule</span><span class="pi">:</span> <span class="s1">'</span><span class="s">0</span><span class="nv"> </span><span class="s">1</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*'</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-compliance-scans-worker-node_compliance-operator-scans"><a class="anchor" href="#running-compliance-scans-worker-node_compliance-operator-scans"></a>Scheduling the result server pod on a worker node</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The result server pod mounts the persistent volume (PV) that stores the raw Asset Reporting Format (ARF) scan results. The <code>nodeSelector</code> and <code>tolerations</code> attributes enable you to configure the location of the result server pod.</p>
</div>
<div class="paragraph">
<p>This is helpful for those environments where control plane nodes are not permitted to mount persistent volumes.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Create a <code>ScanSetting</code> custom resource (CR) for the Compliance Operator:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Define the <code>ScanSetting</code> CR, and save the YAML file, for example, <code>rs-workers.yaml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">compliance.openshift.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ScanSetting</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">rs-on-workers</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">openshift-compliance</span>
<span class="na">rawResultStorage</span><span class="pi">:</span>
  <span class="na">nodeSelector</span><span class="pi">:</span>
    <span class="s">node-role.kubernetes.io/worker</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="na">pvAccessModes</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">ReadWriteOnce</span>
  <span class="na">rotation</span><span class="pi">:</span> <span class="m">3</span>
  <span class="na">size</span><span class="pi">:</span> <span class="s">1Gi</span>
  <span class="na">tolerations</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">operator</span><span class="pi">:</span> <span class="s">Exists</span> <i class="conum" data-value="2"></i><b>(2)</b>
<span class="na">roles</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">worker</span>
<span class="pi">-</span> <span class="s">master</span>
<span class="na">scanTolerations</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">operator</span><span class="pi">:</span> <span class="s">Exists</span>
<span class="na">schedule</span><span class="pi">:</span> <span class="s">0 1 * * *</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The Compliance Operator uses this node to store scan results in ARF format.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The result server pod tolerates all taints.</td>
</tr>
</table>
</div>
</li>
<li>
<p>To create the <code>ScanSetting</code> CR, run the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc create <span class="nt">-f</span> rs-workers.yaml</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Verification</div>
<ul>
<li>
<p>To verify that the <code>ScanSetting</code> object is created, run the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get scansettings rs-on-workers <span class="nt">-n</span> openshift-compliance <span class="nt">-o</span> yaml</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example output</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="go">apiVersion: compliance.openshift.io/v1alpha1
kind: ScanSetting
metadata:
  creationTimestamp: "2021-11-19T19:36:36Z"
  generation: 1
  name: rs-on-workers
  namespace: openshift-compliance
  resourceVersion: "48305"
  uid: 43fdfc5f-15a7-445a-8bbc-0e4a160cd46e
rawResultStorage:
  nodeSelector:
    node-role.kubernetes.io/worker: ""
  pvAccessModes:
  - ReadWriteOnce
  rotation: 3
  size: 1Gi
  tolerations:
  - operator: Exists
roles:
- worker
- master
scanTolerations:
- operator: Exists
schedule: 0 1 * * *
strictNodeScan: true</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="compliance-scansetting-cr_compliance-operator-scans"><a class="anchor" href="#compliance-scansetting-cr_compliance-operator-scans"></a><code>ScanSetting</code> Custom Resource</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>ScanSetting</code> Custom Resource now allows you to override the default CPU and memory limits of scanner pods through the scan limits attribute. The Compliance Operator will use defaults of 500Mi memory, 100m CPU for the scanner container, and 200Mi memory with 100m CPU for the <code>api-resource-collector</code> container. To set the memory limits of the Operator, modify the <code>Subscription</code> object if installed through OLM or the Operator deployment itself.</p>
</div>
<div class="paragraph">
<p>To increase the default CPU and memory limits of the Compliance Operator, see <em>Increasing Compliance Operator resource limits</em>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Increasing the memory limit for the Compliance Operator or the scanner pods is needed if the default limits are not sufficient and the Operator or scanner pods are ended by the Out Of Memory (OOM) process.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="co-hcp-mgmt-config_compliance-operator-scans"><a class="anchor" href="#co-hcp-mgmt-config_compliance-operator-scans"></a>Configuring the hosted control planes management cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you are hosting your own Hosted control plane or Hypershift environment and want to scan a Hosted Cluster from the management cluster, you will need to set the name and prefix namespace for the target Hosted Cluster. You can achieve this by creating a <code>TailoredProfile</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This procedure only applies to users managing their own hosted control planes environment.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only <code>ocp4-cis</code> and <code>ocp4-pci-dss</code> profiles are supported in hosted control planes management clusters.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The Compliance Operator is installed in the management cluster.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Obtain the <code>name</code> and <code>namespace</code> of the hosted cluster to be scanned by running the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc get hostedcluster <span class="nt">-A</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example output</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="go">NAMESPACE       NAME                   VERSION   KUBECONFIG                              PROGRESS    AVAILABLE   PROGRESSING   MESSAGE
local-cluster   79136a1bdb84b3c13217   4.13.5    79136a1bdb84b3c13217-admin-kubeconfig   Completed   True        False         The hosted control plane is available</span></code></pre>
</div>
</div>
</li>
<li>
<p>In the management cluster, create a <code>TailoredProfile</code> extending the scan Profile and define the name and namespace of the Hosted Cluster to be scanned:</p>
<div class="listingblock">
<div class="title">Example <code>management-tailoredprofile.yaml</code></div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">compliance.openshift.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">TailoredProfile</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">hypershift-cisk57aw88gry</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">openshift-compliance</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">description</span><span class="pi">:</span> <span class="s">This profile test required rules</span>
  <span class="na">extends</span><span class="pi">:</span> <span class="s">ocp4-cis</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="na">title</span><span class="pi">:</span> <span class="s">Management namespace profile</span>
  <span class="na">setValues</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">ocp4-hypershift-cluster</span>
    <span class="na">rationale</span><span class="pi">:</span> <span class="s">This value is used for HyperShift version detection</span>
    <span class="na">value</span><span class="pi">:</span> <span class="s">79136a1bdb84b3c13217</span> <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">ocp4-hypershift-namespace-prefix</span>
    <span class="na">rationale</span><span class="pi">:</span> <span class="s">This value is used for HyperShift control plane namespace detection</span>
    <span class="na">value</span><span class="pi">:</span> <span class="s">local-cluster</span> <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Variable. Only <code>ocp4-cis</code> and <code>ocp4-pci-dss</code> profiles are supported in hosted control planes management clusters.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>value</code> is the <code>NAME</code> from the output in the previous step.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>value</code> is the <code>NAMESPACE</code> from the output in the previous step.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Create the <code>TailoredProfile</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="gp">$</span><span class="w"> </span>oc create <span class="nt">-n</span> openshift-compliance <span class="nt">-f</span> mgmt-tp.yaml</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="compliance-applying-resource-requests-and-limits_compliance-operator-scans"><a class="anchor" href="#compliance-applying-resource-requests-and-limits_compliance-operator-scans"></a>Applying resource requests and limits</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the kubelet starts a container as part of a Pod, the kubelet passes that container&#8217;s requests and limits for memory and CPU to the container runtime. In Linux, the container runtime configures the kernel cgroups that apply and enforce the limits you defined.</p>
</div>
<div class="paragraph">
<p>The CPU limit defines how much CPU time the container can use. During each scheduling interval, the Linux kernel checks to see if this limit is exceeded. If so, the kernel waits before allowing the cgroup to resume execution.</p>
</div>
<div class="paragraph">
<p>If several different containers (cgroups) want to run on a contended system, workloads with larger CPU requests are allocated more CPU time than workloads with small requests. The memory request is used during Pod scheduling. On a node that uses cgroups v2, the container runtime might use the memory request as a hint to set <code>memory.min</code> and <code>memory.low</code> values.</p>
</div>
<div class="paragraph">
<p>If a container attempts to allocate more memory than this limit, the Linux kernel out-of-memory subsystem activates and intervenes by stopping one of the processes in the container that tried to allocate memory. The memory limit for the Pod or container can also apply to pages in memory-backed volumes, such as an emptyDir.</p>
</div>
<div class="paragraph">
<p>The kubelet tracks <code>tmpfs</code> <code>emptyDir</code> volumes as container memory is used, rather than as local ephemeral storage. If a container exceeds its memory request and the node that it runs on becomes short of memory overall, the Pod&#8217;s container might be evicted.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A container may not exceed its CPU limit for extended periods. Container run times do not stop Pods or containers for excessive CPU usage. To determine whether a container cannot be scheduled or is being killed due to resource limits, see <em>Troubleshooting the Compliance Operator</em>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="compliance-scheduling-pods-with-resource-requests_compliance-operator-scans"><a class="anchor" href="#compliance-scheduling-pods-with-resource-requests_compliance-operator-scans"></a>Scheduling Pods with container resource requests</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a Pod is created, the scheduler selects a Node for the Pod to run on. Each node has a maximum capacity for each resource type in the amount of CPU and memory it can provide for the Pods. The scheduler ensures that the sum of the resource requests of the scheduled containers is less than the capacity nodes for each resource type.</p>
</div>
<div class="paragraph">
<p>Although memory or CPU resource usage on nodes is very low, the scheduler might still refuse to place a Pod on a node if the capacity check fails to protect against a resource shortage on a node.</p>
</div>
<div class="paragraph">
<p>For each container, you can specify the following resource limits and request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="terminal"><span class="go">spec.containers[].resources.limits.cpu
spec.containers[].resources.limits.memory
</span><span class="gp">spec.containers[].resources.limits.hugepages-&lt;size&gt;</span><span class="w">
</span><span class="go">spec.containers[].resources.requests.cpu
spec.containers[].resources.requests.memory
</span><span class="gp">spec.containers[].resources.requests.hugepages-&lt;size&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Although you can specify requests and limits for only individual containers, it is also useful to consider the overall resource requests and limits for a pod. For a particular resource, a container resource request or limit is the sum of the resource requests or limits of that type for each container in the pod.</p>
</div>
<div class="listingblock">
<div class="title">Example container resource requests and limits</div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">frontend</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">securityContext</span><span class="pi">:</span>
    <span class="na">runAsNonRoot</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">seccompProfile</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">RuntimeDefault</span>
  <span class="na">containers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">app</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">images.my-company.example/app:v4</span>
    <span class="na">resources</span><span class="pi">:</span>
      <span class="na">requests</span><span class="pi">:</span> <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">64Mi"</span>
        <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">250m"</span>
      <span class="na">limits</span><span class="pi">:</span> <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">128Mi"</span>
        <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">500m"</span>
    <span class="na">securityContext</span><span class="pi">:</span>
      <span class="na">allowPrivilegeEscalation</span><span class="pi">:</span> <span class="no">false</span>
      <span class="na">capabilities</span><span class="pi">:</span>
        <span class="na">drop</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">ALL</span><span class="pi">]</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">log-aggregator</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">images.my-company.example/log-aggregator:v6</span>
    <span class="na">resources</span><span class="pi">:</span>
      <span class="na">requests</span><span class="pi">:</span>
        <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">64Mi"</span>
        <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">250m"</span>
      <span class="na">limits</span><span class="pi">:</span>
        <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">128Mi"</span>
        <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">500m"</span>
    <span class="na">securityContext</span><span class="pi">:</span>
      <span class="na">allowPrivilegeEscalation</span><span class="pi">:</span> <span class="no">false</span>
      <span class="na">capabilities</span><span class="pi">:</span>
        <span class="na">drop</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">ALL</span><span class="pi">]</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The container is requesting 64 Mi of memory and 250 m CPU.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The container&#8217;s limits are 128 Mi of memory and 500 m CPU.</td>
</tr>
</table>
</div>
</div>
</div>
      </div>
    </div>
  </div>
  <script src="https://assets.openshift.net/content/modernizr.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/subdomain.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/nav-tertiary.js" type="text/javascript"></script>
  <script src="https://docs.okd.io/latest/_javascripts/bootstrap-offcanvas.js" type="text/javascript"></script>
  <script src="https://docs.okd.io/latest/_javascripts/reformat-html.js" type="text/javascript"></script>
  <script src="https://docs.okd.io/latest/_javascripts/hc-search.js" type="text/javascript"></script>
  <script src="https://docs.okd.io/latest/_javascripts/page-loader.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" type="text/javascript"></script>
  <script src="https://docs.okd.io/latest/_javascripts/clipboard.js" type="text/javascript"></script>
  <script src="https://docs.okd.io/latest/_javascripts/collapsible.js" type="text/javascript"></script>
  <script>
  var dk = 'openshift-aro';
  var version = 'Branch Build';

  var distros = {
    'openshift-origin': ['docs_origin', version],
    // specific labels are used for OSD instead of the URL filter, due to its unusual URL structure; assume v4
    'openshift-dedicated': ['docs_dedicated_v4'],
    'openshift-online': ['docs_online', version],
    'openshift-enterprise': ['docs_cp', version],
    'openshift-telco': ['docs_telco', version],
    'openshift-aro' : ['docs_aro', version],
    'openshift-rosa' : ['docs_rosa'],
    'openshift-acs' : ['docs_acs', version],
    'openshift-serverless' : ['docs_serverless', version],
    'openshift-pipelines' : ['docs_pipelines', version],
    'openshift-builds' : ['docs_builds', version],
    'openshift-gitops' : ['docs_gitops', version],
    'openshift-lightspeed' : ['docs_lightspeed', version],
    'openshift-service-mesh' : ['docs_service_mesh', version]
  };

  // only OSD v3 docs have the version variable specified
  if (dk == "openshift-dedicated" && version == "3") {
    distros['openshift-dedicated'] = ['docs_dedicated_v3']
  }

  distros[dk] ? hcSearchCategory.apply(null, distros[dk]) : hcSearchCategory("docs");
  </script>
  <script type="text/javascript">
  /*<![CDATA[*/
  $(document).ready(function() {
    $("[id^='topicGroup']").on('show.bs.collapse', function(event) {
      if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
        $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
      }
    });
    $("[id^='topicGroup']").on('hide.bs.collapse', function(event) {
      if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
        $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
      }
    });
    $("[id^='topicSubGroup']").on('show.bs.collapse', function() {
      $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });
    $("[id^='topicSubGroup']").on('hide.bs.collapse', function() {
      $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });
    $("[id^='topicSubSubGroup']").on('show.bs.collapse', function() {
      $(this).parent().find("[id^='ssgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });
    $("[id^='topicSubSubGroup']").on('hide.bs.collapse', function() {
      $(this).parent().find("[id^='ssgSpan']").toggleClass("fa-caret-right fa-caret-down");
    });

    const collapsibleContent = document.getElementsByTagName("details");
    for (var i = 0; i < collapsibleContent.length; i++) {
      collapsibleContent[i].setAttribute("open", "");
    }

  });
  /*]]>*/
  </script>

  <footer id="rh">

    <div class="container">
        <div class="row">

            <div class="col-sm-2">
                <img src="https://assets.openshift.net/content/img/Logo-Red_Hat-OpenShift-A-Reverse-RGB.svg" class="img-fluid" alt="Red Hat" style="height: 30px;">
            </div>

            <div class="col-sm-3">
              <p class="text-nowrap">Copyright © 2025 Red Hat, Inc.</p>
            </div>



            <div class="col">
                <nav class="nav">
                    <a target="_blank" href="https://www.redhat.com/en/about/privacy-policy" class="nav-link">Privacy statement</a>
                    <a target="_blank" href="https://www.openshift.com/legal/terms/" class="nav-link">Terms of use</a>
                    <a target="_blank" href="https://www.redhat.com/en/about/all-policies-guidelines" class="nav-link">All policies and guidelines</a>
                    <a id="teconsent"></a>
                </nav>
            </div>
        </div>
    </div>
</footer>
<div id="consent_blackbar" style="z-index: 100; position: fixed"></div>



<!-- Adobe DTM -->
<script type="text/javascript">
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
   _satellite.pageBottom();
}
</script>
<!-- End Adobe DTM -->

  <!-- adjust page css based on breadcrumb and/or resize -->
  <script type="text/javascript">
    window.addEventListener('DOMContentLoaded', () => {
      if ($(window).width() >= 1008) {
        adjustSide();
        adjustToc();
        adjustMain();
      }
    });

    window.addEventListener('resize', () => {
      if ($(window).width() >= 1008) {
        adjustSide();
        adjustToc();
        adjustMain();
      } else if ($(window).width() < 1008) {
        sidebar.classList.remove('wide');
        document.querySelector('#hc-search').classList.remove('wide');
        if (sidebar.classList.contains('open')) {
          sidebar.style.display = 'block';
        } else {
          sidebar.style.display = 'none';
        }
        document.querySelector('.main').style.paddingTop = '0px';
      }
    });

    function adjustSide() {
      sidebar.classList.add('wide');
      document.querySelector('#hc-search').classList.add('wide');
      sidebar.style.display = 'block';
      document.querySelector('.sidebar').style.top = parseInt((document.querySelector('.breadcrumb').offsetHeight + 125), 10) + "px";
      document.querySelector('#hc-search').style.top = parseInt((document.querySelector('.breadcrumb').offsetHeight + 95), 10) + "px";
    }

    function adjustToc() {
      if (document.querySelector('#toc') !== null) {
        document.querySelector('#toc').style.top = parseInt((document.querySelector('.breadcrumb').offsetHeight + 90), 10) + "px";
      }
    }

    function adjustMain() {
      document.querySelector('html').style.scrollPaddingTop = parseInt((document.querySelector('.breadcrumb').offsetHeight + 90), 10) + "px";
      document.querySelector('.main').style.paddingTop = parseInt((document.querySelector('.breadcrumb').offsetHeight - 70), 10) + "px";
    }

  </script>

  <!-- remove toc active class when page is loaded -->
  <script type="text/javascript">
    window.addEventListener('DOMContentLoaded', () => {
      var tocItems = $("#toc a");

      for (let i = 0; i < tocItems.length; i++) {
        tocItems[i].classList.remove("toc-active");
      }
    })
  </script>

  <!-- maintain sidebar scroll position between page loads -->
  <script type="text/javascript">
    let sidebar = document.querySelector(".sidebar");
    let scrolltop = localStorage.getItem("sidebar-scroll");

    if (scrolltop == null) {
      sidebar.scrollTop = parseInt(top, 10);
    }

    window.addEventListener("beforeunload", () => {
      localStorage.setItem("sidebar-scroll", sidebar.scrollTop);
    });

    window.addEventListener('load', () => {
      sidebar.scrollTo(0, scrolltop)
    })
  </script>

  <!-- open/close the nav -->
  <script type="text/javascript">
    function closeNav() {
      let sidebar = document.querySelector(".sidebar");
      sidebar.style.display = "none";
      sidebar.classList.remove('open');
    }

    function openNav() {
      let sidebar = document.querySelector(".sidebar");
      let hc_search = document.querySelector('#hc-search');
      sidebar.style.display = "block";
      sidebar.style.top = "0px";
      hc_search.style.top = 'unset';
      sidebar.classList.add('open');
    }
  </script>

  <!-- clear and add toc-active to clicked toc link -->
  <script type="text/javascript">
  $("#toc a").click(function() {
    var tocItems = $("#toc a");
    for (let i = 0; i < tocItems.length; i++) {
      tocItems[i].classList.remove("toc-active");
    }
    this.classList.add("toc-active");
  });
  </script>

  <!-- update active toc class when mouse scrolls -->
  <script type="text/javascript">
    window.addEventListener('DOMContentLoaded', () => {
      window.addEventListener("wheel", () => {

        const ioConfiguration = {
          "rootMargin": "-120px 0px -400px 0px",
          "threshold": 0
        };

        const observer = new IntersectionObserver(setCurrent, ioConfiguration, entries => {
          entries.forEach(entry => {
            var id = entry.target.getAttribute('id');
            //fight with js
            document.querySelector(`#toc li a[href="#${id}"]`).classList.remove('toc-active');
          });
        });

        //track all h1-4 headings that have an id
        document.querySelectorAll('.main h2[id], .main h3[id]').forEach((h) => {
          observer.observe(h);
        });

        //runs when the IntersectionObserver fires
        function setCurrent(e) {
          var allTocLinks = document.querySelectorAll("#toc li a");
          if (allTocLinks !== undefined) {
            e.map(i => {
              if (i.isIntersecting && i.intersectionRatio >= 1) {
                allTocLinks.forEach(link => link.classList.remove("toc-active"));
                document.querySelector(`#toc li a[href="#${i.target.id}"]`).classList.add('toc-active')
              }
            })
          }
        };

        //make clicked toc item active and stop IntersectionObserver
        $("#toc a").click(function() {
          //stop tracking all h1-4 headings that have an id
          document.querySelectorAll('.main h2[id], .main h3[id]').forEach((h) => {
            observer.unobserve(h);
          });
          var tocItems = $("#toc a");
          if (tocItems !== undefined) {
            for (let i = 0; i < tocItems.length; i++) {
              tocItems[i].classList.remove("toc-active");
            };
            this.classList.add("toc-active");
          }
        })
      })
    })
  </script>

  <!--handle page scroll top and bottom, add toc-active -->
  <script type="text/javascript">
    document.addEventListener('scroll', () => {
      //scroll to bottom
      if(document.documentElement.scrollHeight === window.pageYOffset + window.innerHeight) {
        var tocItems = $("#toc a");
        for (let i = 0; i < tocItems.length; i++) {
          tocItems[i].classList.remove("toc-active")
          };
          tocItems[tocItems.length - 1].classList.add("toc-active");
        };
      //scroll to top
      if(window.pageYOffset === 0) {
        var tocItems = $("#toc a");
        for (let i = 0; i < tocItems.length; i++) {
          tocItems[i].classList.remove("toc-active");
          };
          tocItems[0].classList.add("toc-active");
        };
      })
  </script>

  <!-- adjust alerts on mobile -->
  <script type="text/javascript">
    alert = document.querySelector('#support-alert')
    window.addEventListener("wheel", () => {
      if ($(window).width() < 1008) {
        //adjust alert
        if(window.pageYOffset > 0) {
          if(alert !== null) {
            document.querySelector('#support-alert').style.position = "fixed";
            document.querySelector('#support-alert').style.bottom = "0px";
            document.querySelector('#support-alert').style.margin = "5px";
            document.querySelector('#support-alert').style.zIndex = "9999999";
          }
        }
      }
   });
    window.addEventListener('resize', () => {
      if ($(window).width() >= 1008) {
        if(alert !== null) {
          document.querySelector('#support-alert').style.removeProperty('position');
          document.querySelector('#support-alert').style.removeProperty('bottom');
          document.querySelector('#support-alert').style.removeProperty('margin');
          document.querySelector('#support-alert').style.removeProperty('zIndex');
        }
      }
    })
  </script>

  <!-- hide footer after 3 seconds -->
  <script type="text/javascript">
    const hideFooter = () => {
      document.querySelector('footer#rh, footer.footer-origin-docs').style.display = "none";
    };

    window.addEventListener('load', function() {
      setTimeout(hideFooter, 3000);
    });
  </script>
</body>
</html>